<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Akamai Component Examples</title>
        <link rel="stylesheet" href="../node_modules/pulsar-common-css/dist/styles.css">
    </head>
    <body ng-app="example" ng-controller="ExampleController" class="common-css luna">
        <div class="container">
            <div class="page-header">
                <h1>Data Table Component Example</h1>
                <h5>Note that after the initial load the data is cached so the Indeterminate Progress Indicator will not reappear unless the page is reloaded.</h5>
                <h5>When the menubutton is selected on a row in the table, the full name will appear in an alert to demonstrate obtaining the selected row.</h5> 
              
            </div>        
            <div class="container">
                <h3>Data From HTTP GET</h3>
                <h5>Example contains 3 rows pre-selected</h3>
                <akam-data-table data="mydata" schema="schema" filter-placeholder="Filter Employees" show-checkboxes="true" selected-items="selectedItems1">
                    <akam-menu-button position="right">
                        <akam-menu-button-item text="PDF" ng-click="process($event, 'PDF', $parent.$parent.$parent.item)"></akam-menu-button-item>
                        <akam-menu-button-item text="HTML" ng-click="process($event, 'HTML', $parent.$parent.$parent.item)"></akam-menu-button-item>
                    </akam-menu-button>
                </akam-data-table>
                <span>Selected Items: </br> {{selectedItems1}}</span>
            </div>
            </br>
            <div class="container">
                <h3>Example of Empty Data Table</h3>
                <akam-data-table data="[]" schema="schema" filter-placeholder="Filter Employees" no-data-message="no results given">
                    <akam-menu-button position="right">
                        <akam-menu-button-item text="PDF" ng-click="process($event, 'PDF', $parent.$parent.$parent.item)"></akam-menu-button-item>
                        <akam-menu-button-item text="HTML" ng-click="process($event, 'HTML', $parent.$parent.$parent.item)"></akam-menu-button-item>
                    </akam-menu-button>
                </akam-data-table>
            </div>    
        </div>
        <script src="../node_modules/angular/angular.js"></script>
        <script src="../dist/akamai-components.js"></script>
        <script>
            angular.module('example', ['akamai.components.data-table'])
    
            .controller('ExampleController', ["$scope", "$http", "$filter", function($scope, $http, $filter) {
                $scope.processSelected = function(){
                    console.log('haha');
                };
            
            $scope.mydata = $http.get('json/component_mockdata.json').then(function(results) {    
              // set a few selected items
              $scope.selectedItems1 = [results.data[1], results.data[3], results.data[7]];
              return results.data;
            });
            
            $scope.schema = [
                {
                    // Concentenate the first_name and last_name fields into full name
                    content : function(){
                    //NOTE that the "this" context for the function call will the object being worked on and not the column itself    
                    return this.first_name + ' ' + this.last_name;
                },
                    header : 'Full Name',
                    className : 'column-full-name',
                    sort:true,
                },
                {
                    content : 'id',
                    header : 'Emp. ID',
                    className : 'column-employeeid',
                    sort:true,
                },
                {
                    content : 'email',
                    header : 'EMAIL',
                    className : 'column-email',
                    sort:true,
                },
                {
                    content : 'country',
                    header : 'Country',
                    className : 'column-country',
                    sort:true,
                },
                {
                    content : 'ip_address',
                    header : 'IP Address',
                    className : 'column-ipaddress',
                    sort:true,
                },
                {
                    content : 'boolean',
                    header : 'Boolean',
                    className : 'column-boolean',
                    // Without defaultValue specified the false value will not appear
                    defaultValue : false
                },
                {
                    content : 'color',
                    header : 'Color',
                    className : 'column-color',
                    // Custom sort defined for the color where values are associated with specific colors
                    sort: function(){
                        var colorsValues = {
                            'Red' : 1,
                            'Yellow' : 2,
                            'Green' : 3,
                            'Blue' : 4
                        };
                        return colorsValues[this.color];
                    }
                },               
            ];
            
            // When the row changes display what is selected
            $scope.rowChange = function(value){
                console.log('Row selected', value);
            };
            
            // Process the menu clicked event
            $scope.process = function($event, type, item){
                console.log('Menu item clicked:' + type, item.cells);
                
                // When the menubutton is selcted on a row in the table, the full name will appear in an alert to test out getting data from the selected row.
                alert('Employee Selected:' + item.cells[0]);
            };
            
            }]);
        </script>
    </body>
</html>