<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Akamai Component Examples - Wizard</title>
    <link rel="stylesheet" href="../dist/akamai-core.css">

    <style>
        div h2:first-child {
            margin-bottom:10px;
        }
        body.luna > h1 {
            margin-bottom:20px;
        }

        body.luna > div > span {
            display: inline-block;
            width: 180px;
        }
    </style>
</head>

<body class="common-css luna" ng-app="wizardApp" ng-strict-di ng-controller="WizardAppController as vm">

    <script type="text/ng-template" id="step1">
        <div>step 1 content</div>
    </script>
    <script type="text/ng-template" id="step2">
        <div>step 2 content</div>
    </script>
    <script type="text/ng-template" id="step3">
        <div>step 3 content</div>
    </script>
    <script type="text/ng-template" id="step4">
        <div>step 4 content</div>
    </script>

    <h1>Wizard Component examples</h1>

    <div ng-click="vm.launchWizard()" style="cursor:pointer;">
        Launch wizard
    </div>
    <br/>

    <script src="../dist/akamai-core.js"></script>

    <script>
        angular.module('wizardApp', ['akamai.components.wizard'])
                .controller('WizardAppController', WizardAppController)
                .config(configFunction);


        WizardAppController.$inject = ['$log', '$modal', 'wizard', '$rootScope', '$q', '$timeout'];
        function WizardAppController($log, $modal, wizard, $rootScope, $q, $timeout) {
            var vm = this;
            var wizardScope = $rootScope.$new();
            var times = 0;

            WizardController.$inject = ['$scope', '$log'];
            function WizardController($scope, $log) {
                if (angular.isFunction($scope.setOnSubmit)) {
                    $scope.setOnSubmit(function(){
                        var deferral = $q.defer();
                        $timeout(function() {
                            if (times % 2 === 0) {
                                deferral.reject();
                            } else{
                                deferral.resolve();
                            }

                            times++;
                        }, 1000);
                        return deferral.promise;
                    });
                }
            };

            vm.launchWizard = function() {
                wizard.open({
                    scope: wizardScope,
                    controller: WizardController,
                    title: 'Wizard Example',
                    successMessage: 'Success Message',
                    errorMessage: 'Error Message',
                    steps: [
                        {
                            name: 'Step 1',
                            templateId: 'step1',
                            validate: function(scope) {
                                return true;
                            }
                        },
                        {
                            name: 'Step 2',
                            templateId: 'step2',
                            validate: function(scope) {
                                return true;
                            }

                        },
                        {
                            name: 'Step 3',
                            templateId: 'step3',
                            validate: function(scope) {
                                return true;
                            }
                        },
                        {
                            name: 'Step 4',
                            templateId: 'step4',
                            validate: function(scope) {
                                return true;
                            }

                        }
                    ]
                });
            };
        }

        configFunction.$inject = ['i18nTokenProvider'];
        function configFunction (i18nTokenProvider) {
            // need to overwrite locales path on fee.akamai.com
            if(window.location.host == 'fee.akamai.com') {
                i18nTokenProvider.setComponentLocalePath("../dist/locales/");
                i18nTokenProvider.setAppLocalePath("locales/json/messages/");
            }
        }

    </script>

</body>
</html>